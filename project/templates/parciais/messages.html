{% if messages %}
    <div class="messages-container space-y-3 mt-2">
        {% for message in messages %}
            <div class="message-alert 
                        {% if message.tags == 'error' or message.tags == 'danger' %}
                            bg-gradient-to-r from-red-50 to-red-100 border-l-4 border-red-500 text-red-800
                        {% elif message.tags == 'success' %}
                            bg-gradient-to-r from-green-50 to-green-100 border-l-4 border-green-500 text-green-800
                        {% elif message.tags == 'warning' %}
                            bg-gradient-to-r from-yellow-50 to-yellow-100 border-l-4 border-yellow-500 text-yellow-800
                        {% elif message.tags == 'info' %}
                            bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-500 text-blue-800
                        {% else %}
                            bg-gradient-to-r from-gray-50 to-gray-100 border-l-4 border-gray-500 text-gray-800
                        {% endif %}
                        rounded-lg shadow-md p-4 flex items-start gap-3 animate-slideInDown relative overflow-hidden"
                 role="alert">
                
                <!-- Barra de progresso -->
                <div class="message-progress-bar"></div>
                
                <!-- Ícone -->
                <div class="flex-shrink-0 mt-0.5">
                    {% if message.tags == 'error' or message.tags == 'danger' %}
                        <svg class="w-5 h-5 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                        </svg>
                    {% elif message.tags == 'success' %}
                        <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                    {% elif message.tags == 'warning' %}
                        <svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                    {% elif message.tags == 'info' %}
                        <svg class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
                
                <!-- Mensagem -->
                <div class="flex-1 text-sm font-medium leading-relaxed">
                    {{ message|safe }}
                </div>
                
                <!-- Botão de fechar -->
                <button type="button" 
                        class="flex-shrink-0 ml-auto -mx-1.5 -my-1.5 rounded-lg focus:ring-2 focus:ring-offset-1 p-1.5 inline-flex h-8 w-8 items-center justify-center hover:bg-white/50 transition-all duration-200 group"
                        onclick="dismissMessage(this)"
                        aria-label="Fechar">
                    <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>
        {% endfor %}
    </div>

    <style>
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        .animate-slideInDown {
            animation: slideInDown 0.4s ease-out;
        }

        .animate-slideOutRight {
            animation: slideOutRight 0.5s ease-out forwards;
        }

        .message-alert {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .message-alert:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }

        .message-progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                rgba(255, 255, 255, 0.8) 50%, 
                rgba(255, 255, 255, 0.3) 100%);
            animation: progressBar 5s linear forwards;
            border-radius: 0 0 0 8px;
        }

        @keyframes progressBar {
            from {
                width: 100%;
            }
            to {
                width: 0%;
            }
        }

        /* Estilos para conteúdo HTML dentro das mensagens */
        .message-alert strong,
        .message-alert b {
            font-weight: 700;
        }

        .message-alert a {
            text-decoration: underline;
            font-weight: 600;
        }

        .message-alert a:hover {
            opacity: 0.8;
        }
    </style>

    <script>
        // Auto-dismiss messages após 5 segundos com animação suave
        document.addEventListener('DOMContentLoaded', function() {
            const messages = document.querySelectorAll('.message-alert');
            messages.forEach((message, index) => {
                // Adiciona delay crescente para cada mensagem
                const dismissDelay = 5000 + (index * 500); // 5s base + 0.5s por mensagem adicional
                
                setTimeout(() => {
                    message.classList.add('animate-slideOutRight');
                    
                    setTimeout(() => {
                        message.remove();
                        
                        // Remove container se não houver mais mensagens
                        const container = document.querySelector('.messages-container');
                        if (container && container.children.length === 0) {
                            container.remove();
                        }
                    }, 500);
                }, dismissDelay);
            });
        });

        // Função para fechar mensagem manualmente
        function dismissMessage(button) {
            const message = button.closest('.message-alert');
            message.classList.add('animate-slideOutRight');
            
            setTimeout(() => {
                message.remove();
                
                // Remove container se não houver mais mensagens
                const container = document.querySelector('.messages-container');
                if (container && container.children.length === 0) {
                    container.remove();
                }
            }, 500);
        }
    </script>
{% endif %}